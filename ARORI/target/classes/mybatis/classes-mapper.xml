<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="classes">

	<!-- 클래스 시퀀스 발급 -->
	<select id="getSeq" resultType="int">
		SELECT classes_SEQ.NEXTVAL FROM DUAL
	</select>
	<!-- 클래스 생성 -->
	<insert id="createClasses" parameterType="classesDto">
		INSERT INTO classes VALUES(#{c_no}, #{member_no}, #{c_title}, #{c_public}, 0, SYSDATE, #{c_info})
	</insert>
	<!-- 단일 조회 -->
	<select id="get" parameterType="int" resultType="classesDto">
		SELECT * FROM classes WHERE c_no=#{c_no}
	</select>
	<!-- 내 클래스 조회 -->
	<select id="myList" parameterType="int" resultType="classesDto">
		SELECT * FROM Classes WHERE member_no=#{member_no}
	</select>	
	<!-- 목록 조회 -->
	<select id="getList" resultType="classesDto">
		SELECT * FROM classes ORDER BY c_no DESC
	</select>
	<!-- 정보 수정 -->
	<update id="edit" parameterType="classesDto">
		UPDATE classes SET c_title=#{c_title}, c_info=#{c_info}, c_public=#{c_public} WHERE c_no=#{c_no}
	</update>
	<!-- 클래스 삭제 -->
	<delete id="delete" parameterType="int">
		DELETE classes WHERE c_no=#{c_no}
	</delete>
	<!-- 검색 -->
	<select id="search" parameterType="map" resultType="mcDto">
		SELECT * FROM MC WHERE INSTR(${searchOption}, #{keyword}) > 0 ORDER BY C_WHEN DESC
	</select>

	<!-- 클래스 주인인지 증명하기 위해 조회  -->
	<select id="checkM" resultType="classesDto" parameterType="classesDto">
		SELECT * FROM CLASSES WHERE MEMBER_NO = #{member_no} AND C_NO = #{c_no}
	</select>

</mapper>

